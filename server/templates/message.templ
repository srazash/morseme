package templates

import "morseme/server/message"
import "morseme/server/morsecode"

templ NewMessage() {
    <form id="message-form" hx-target="#message-form" hx-swap="innerHTML" hx-post="/submit-message">
		<fieldset>
			<legend>Message to send</legend>
			<div>
				<label for="message-body">
					Message:
					<input id="message-body" name="message-body" type="text" size="40" spellcheck="true" placeholder="letters and spaces only" maxlength="100" required />
				</label>
			</div>

			<br />

			<div>
				<label for="message-sender">
					Sender:
					<input id="message-sender" name="message-sender" type="text" size="40" spellcheck="true" placeholder="your name (optional)" maxlength="100" />
				</label>
			</div>

			<br />

			<div>
				<input id="message-submit" class="btn btn-primary" type="submit" value="Send" />
			</div>
		</fieldset>
	</form>
}

templ SubmitMessage(m message.Message) {
	<div id="message-form">
		<legend>Message sent</legend>
		if m.MessageSender != "" {
			<div>Thanks { m.MessageSender }, your message has been sent!</div>
		} else {
			<div>Thanks, your message has been sent!</div>
		}
		<pre>{ m.MessageText } --> { morsecode.ErrorlessEncode(m.MessageText) }</pre>
		<br />
		<div>Take note of your ticket # to check on the status of your message:</div>
		<div id="encode-output" class="terminal-alert terminal-alert-primary">
			🎫
			<span id="ticket-num">{ m.MessageTicket }</span>
			<a _="on click log #ticket-num.innerHTML">Copy to clipboard</a>
		</div>
		<br />
		<button class="btn btn-primary" hx-target="#message-form" hx-swap="outerHTML" hx-get="/new-message">Send another message</button>
	</div>
}